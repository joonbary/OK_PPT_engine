<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OK금융그룹 PPT generator</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css?v=1729062033">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h1 class="logo">
                        <i class="fas fa-file-powerpoint"></i>
                        OK금융그룹 PPT generator
                    </h1>
                </div>
                <div class="col-md-6 text-end">
                    <span class="version">v1.0.0</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            
            <!-- Progress Steps -->
            <div class="progress-steps mb-5">
                <div class="step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">문서 입력</div>
                </div>
                <div class="step-line"></div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">옵션 설정</div>
                </div>
                <div class="step-line"></div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">생성 완료</div>
                </div>
            </div>

            <!-- Step 1: 문서 입력 -->
            <div class="step-content active" id="step-1">
                <div class="card shadow-sm">
                    <div class="card-header">
                        <h3><i class="fas fa-file-alt"></i> 비즈니스 문서 입력</h3>
                        <p class="text-muted">분석할 비즈니스 문서를 입력하거나 파일을 업로드하세요</p>
                    </div>
                    <div class="card-body">
                        
                        <!-- 탭 전환 -->
                        <ul class="nav nav-tabs mb-4" id="inputTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="text-tab" data-bs-toggle="tab" 
                                        data-bs-target="#text-input" type="button">
                                    <i class="fas fa-keyboard"></i> 텍스트 입력
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="file-tab" data-bs-toggle="tab" 
                                        data-bs-target="#file-upload" type="button">
                                    <i class="fas fa-file-upload"></i> 파일 업로드
                                </button>
                            </li>
                        </ul>

                        <!-- 탭 콘텐츠 -->
                        <div class="tab-content" id="inputTabContent">
                            
                            <!-- 텍스트 입력 탭 -->
                            <div class="tab-pane fade show active" id="text-input">
                                <div class="form-group">
                                    <label for="documentInput">문서 내용</label>
                                    <textarea 
                                        id="documentInput" 
                                        class="form-control document-textarea"
                                        rows="12"
                                        placeholder="예시:&#10;&#10;2024년 우리 회사의 매출은 1,000억원으로 전년 대비 20% 증가했습니다.&#10;이는 신제품 라인의 성공적인 출시와 해외 시장 확장 덕분입니다.&#10;&#10;주요 성과:&#10;- 아시아 시장 진출로 매출 300억원 달성&#10;- 신제품이 전체 매출의 40% 기여
- 운영 효율화로 비용 15% 절감&#10;&#10;향후 계획:&#10;- 2025년 매출 목표 1,500억원 (50% 성장)&#10;- 유럽 시장 진출 예정"></textarea>
                                    <div class="char-counter">
                                        <span id="charCount">0</span> / 최소 100자
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 파일 업로드 탭 -->
                            <div class="tab-pane fade" id="file-upload">
                                <div class="upload-container">
                                    <!-- 드래그 앤 드롭 영역 -->
                                    <div class="upload-area" id="uploadArea">
                                        <div class="upload-icon">
                                            <i class="fas fa-cloud-upload-alt"></i>
                                        </div>
                                        <h3>파일을 드래그하거나</h3>
                                        <button type="button" class="btn btn-outline-primary" id="selectFileBtn">
                                            <i class="fas fa-folder-open"></i> 파일 선택
                                        </button>
                                        <input type="file" id="fileInput" accept=".docx,.pdf,.md" hidden>
                                        <div class="upload-info">
                                            <p><strong>지원 형식:</strong> DOCX, PDF, MD</p>
                                            <p><strong>최대 크기:</strong> 10MB</p>
                                        </div>
                                    </div>

                                    <!-- 업로드 진행 상황 -->
                                    <div class="upload-progress-container" id="uploadProgress" style="display: none;">
                                        <div class="upload-progress-bar">
                                            <div class="upload-progress-fill" id="progressFill"></div>
                                        </div>
                                        <p class="upload-status" id="uploadStatus">파일 업로드 중...</p>
                                    </div>

                                    <!-- 업로드된 파일 정보 -->
                                    <div class="file-info-container" id="fileInfo" style="display: none;">
                                        <div class="file-info">
                                            <div class="file-icon">
                                                <i class="fas fa-file-alt"></i>
                                            </div>
                                            <div class="file-details">
                                                <h4 id="fileName"></h4>
                                                <p id="fileSize"></p>
                                            </div>
                                            <button type="button" class="btn-remove" id="removeFileBtn">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                        <div class="file-preview">
                                            <label>추출된 내용 미리보기:</label>
                                            <div class="preview-text" id="previewText"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 다음 버튼 -->
                        <div class="card-footer text-end">
                            <button type="button" class="btn btn-primary btn-lg" id="nextToOptions" disabled>
                                다음 단계 <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: 옵션 설정 -->
            <div class="step-content" id="step-2">
                <div class="card shadow-sm">
                    <div class="card-header">
                        <h3><i class="fas fa-cog"></i> PPT 생성 옵션</h3>
                        <p class="text-muted">원하는 스타일과 설정을 선택하세요</p>
                    </div>
                    <div class="card-body">
                        <div class="row g-4">
                            <!-- 스타일 선택 -->
                            <div class="col-md-6">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-palette"></i> 프레젠테이션 스타일
                                </label>
                                <select id="styleSelect" class="form-select">
                                    <option value="mckinsey" selected>McKinsey 스타일 (권장)</option>
                                    <option value="bcg">BCG 스타일</option>
                                    <option value="bain">Bain 스타일</option>
                                </select>
                            </div>

                            <!-- 타겟 청중 -->
                            <div class="col-md-6">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-users"></i> 타겟 청중
                                </label>
                                <select id="audienceSelect" class="form-select">
                                    <option value="executive" selected>경영진 (Executive)</option>
                                    <option value="management">중간 관리자</option>
                                    <option value="technical">기술팀</option>
                                    <option value="general">일반 청중</option>
                                </select>
                            </div>

                            <!-- 슬라이드 수 -->
                            <div class="col-md-6">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-file-powerpoint"></i> 슬라이드 수
                                </label>
                                <input 
                                    type="range" 
                                    id="numSlidesRange" 
                                    class="form-range" 
                                    min="5" 
                                    max="30" 
                                    value="12"
                                >
                                <div class="text-center mt-2">
                                    <span id="numSlidesValue" class="badge bg-primary">12</span> 장
                                </div>
                            </div>

                            <!-- 언어 -->
                            <div class="col-md-6">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-language"></i> 언어
                                </label>
                                <select id="languageSelect" class="form-select">
                                    <option value="ko" selected>한국어</option>
                                    <option value="en">English</option>
                                    <option value="ja">日本語</option>
                                </select>
                            </div>
                        </div>

                        <!-- 예상 소요 시간 -->
                        <div class="alert alert-info mt-4">
                            <i class="fas fa-clock"></i>
                            <strong>예상 소요 시간:</strong> 약 3-5초
                        </div>
                    </div>
                    <div class="card-footer d-flex justify-content-between">
                        <button id="backToDocument" class="btn btn-outline-secondary btn-lg">
                            <i class="fas fa-arrow-left"></i> 이전
                        </button>
                        <button id="generatePPT" class="btn btn-primary btn-lg">
                            <i class="fas fa-magic"></i> PPT 생성하기
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 3: 생성 진행 상황 -->
            <div class="step-content" id="step-3">
                <div class="card shadow-sm">
                    <div class="card-header">
                        <h3><i class="fas fa-spinner fa-spin"></i> PPT 생성 중...</h3>
                        <p class="text-muted">잠시만 기다려주세요</p>
                    </div>
                    <div class="card-body">
                        <!-- 진행 바 -->
                        <div class="progress mb-4" style="height: 30px;">
                            <div 
                                id="progressBar" 
                                class="progress-bar progress-bar-striped progress-bar-animated" 
                                role="progressbar" 
                                style="width: 0%"
                            >
                                0%
                            </div>
                        </div>

                        <!-- 모드 토글 -->
                        <div class="form-check form-switch mb-3 text-center">
                            <input class="form-check-input" type="checkbox" id="phaseModeToggle" checked>
                            <label class="form-check-label" for="phaseModeToggle">단계별 실행 모드</label>
                        </div>

                        <!-- 현재 단계 표시 -->
                        <div class="current-stage text-center mb-4">
                            <h5 id="currentStage">문서 분석 중...</h5>
                            <p class="text-muted" id="stageDescription">
                                AI가 비즈니스 문서를 분석하고 있습니다
                            </p>
                        </div>

                        <!-- 생성 단계 체크리스트 -->
                        <div class="stage-checklist">
                            <div class="stage-item" data-stage="document_analysis">
                                <i class="fas fa-circle-notch fa-spin"></i>
                                <span>문서 분석</span>
                            </div>
                            <div class="stage-item" data-stage="structure_design">
                                <i class="far fa-circle"></i>
                                <span>구조 설계</span>
                            </div>
                            <div class="stage-item" data-stage="content_generation">
                                <i class="far fa-circle"></i>
                                <span>콘텐츠 생성</span>
                            </div>
                            <div class="stage-item" data-stage="design_application">
                                <i class="far fa-circle"></i>
                                <span>디자인 적용</span>
                            </div>
                            <div class="stage-item" data-stage="quality_review">
                                <i class="far fa-circle"></i>
                                <span>품질 검토</span>
                            </div>
                        </div>

                        <!-- 단계별 제어 버튼 -->
                        <div id="phaseControls" class="d-flex justify-content-center gap-2 mt-3">
                            <button id="btnPhaseAnalyze" class="btn btn-outline-primary btn-sm">분석</button>
                            <button id="btnPhaseStructure" class="btn btn-outline-primary btn-sm">구조설계</button>
                            <button id="btnPhaseContent" class="btn btn-outline-primary btn-sm">콘텐츠</button>
                            <button id="btnPhaseDesign" class="btn btn-outline-primary btn-sm">디자인</button>
                            <button id="btnPhaseReview" class="btn btn-outline-primary btn-sm">리뷰</button>
                            <button id="btnPhaseExport" class="btn btn-primary btn-sm">내보내기</button>
                        </div>

                        <!-- 단계별 결과/오류 출력 -->
                        <div class="mt-3">
                            <pre id="phaseLog" class="bg-light p-3" style="max-height: 220px; overflow:auto;"></pre>
                        </div>

                        <!-- 분석 결과 요약 패널 -->
                        <div id="analyzePanel" class="mt-3" style="display:none;">
                            <div class="card">
                                <div class="card-header"><strong>Stage 1: 문서 분석 결과</strong></div>
                                <div class="card-body">
                                    <p><strong>핵심 메시지:</strong> <span id="coreMessage">-</span></p>
                                    <p><strong>데이터 포인트:</strong> <span id="dataPointCount">0</span>개</p>
                                    <div>
                                        <strong>주요 토픽:</strong>
                                        <ul id="keyTopicsList" class="mt-2" style="margin-bottom:0; padding-left: 1.2rem; list-style: disc;">
                                            <li class="text-muted">-</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 구조 설계 결과 패널 -->
                        <div id="structurePanel" class="mt-3" style="display:none;">
                            <div class="card">
                                <div class="card-header"><strong>Stage 2: 구조 설계 결과</strong></div>
                                <div class="card-body">
                                    <p><strong>슬라이드 개요:</strong></p>
                                    <ul id="slideOutline" class="list-group"></ul>
                                </div>
                            </div>
                        </div>

                        <!-- 품질 점수 (완료 후 표시) -->
                        <div id="qualityScore" class="quality-score mt-4" style="display: none;">
                            <div class="alert alert-success">
                                <h5><i class="fas fa-check-circle"></i> 생성 완료!</h5>
                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <strong>품질 점수:</strong>
                                        <div class="score-badge">
                                            <span id="scoreValue">0.00</span> / 1.00
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <strong>생성 시간:</strong>
                                        <span id="generationTime">0</span>초
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer text-center">
                        <button 
                            id="downloadPPT" 
                            class="btn btn-success btn-lg" 
                            style="display: none;"
                        >
                            <i class="fas fa-download"></i> PPT 다운로드
                        </button>
                        <button 
                            id="createNew" 
                            class="btn btn-outline-primary btn-lg ms-3" 
                            style="display: none;"
                        >
                            <i class="fas fa-plus"></i> 새로 만들기
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container text-center">
            <p>&copy; 2025 McKinsey PPT Generator | Powered by AI</p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="js/api.js?v=1729062033"></script>
    <script src="js/app.js?v=1729062033"></script>
</body>
</html>
