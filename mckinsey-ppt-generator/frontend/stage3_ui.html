<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stage 3: ì½˜í…ì¸  ìƒì„±</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .stage-container {
            background-color: #ffffff;
            border: 1px solid #d9d9d9;
            border-radius: 8px;
            padding: 24px;
            width: 600px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .stage-header {
            font-size: 20px;
            font-weight: 600;
            border-bottom: 1px solid #d9d9d9;
            padding-bottom: 16px;
            margin-bottom: 16px;
        }
        .progress-status {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
            font-size: 14px;
            color: #595959;
        }
        .slide-preview-area {
            background-color: #fafafa;
            border: 1px solid #e8e8e8;
            border-radius: 4px;
            padding: 16px;
            margin-bottom: 16px;
            height: 350px; /* Fixed height for stability */
        }
        .slide-preview-area h3 {
            font-size: 16px;
            margin-top: 0;
            margin-bottom: 12px;
        }
        .slide-content {
            font-size: 14px;
        }
        .slide-content .headline {
            font-weight: bold;
            margin-bottom: 12px;
        }
        .slide-content .insights ul, .slide-content .actions ul {
            list-style-type: none;
            padding-left: 0;
            margin: 8px 0 0 0;
        }
        .slide-content .insights li, .slide-content .actions li {
            margin-bottom: 6px;
        }
        .slide-content .actions .priority-high {
            font-weight: bold;
            color: #f5222d;
        }
        .action-buttons {
            display: flex;
            justify-content: space-between;
            gap: 12px;
        }
        .action-buttons button {
            padding: 10px 20px;
            border-radius: 4px;
            border: 1px solid #d9d9d9;
            cursor: pointer;
            font-size: 14px;
        }
        .action-buttons .next-btn {
            background-color: #1890ff;
            color: white;
            border-color: #1890ff;
        }
        .action-buttons .next-btn:disabled {
            background-color: #a0d9ff;
            border-color: #a0d9ff;
            cursor: not-allowed;
        }
        .action-buttons .pause-btn {
            background-color: #faad14;
            color: white;
            border-color: #faad14;
        }
    </style>
</head>
<body>

<div class="stage-container">
    <div class="stage-header">Stage 3: ì½˜í…ì¸  ìƒì„±</div>

    <div class="progress-status">
        <span id="generation-progress">ğŸ”„ ìƒì„± ì¤€ë¹„ ì¤‘...</span>
        <span id="time-remaining">â±ï¸ ì˜ˆìƒ ì‹œê°„: --</span>
    </div>

    <div class="slide-preview-area">
        <h3>ğŸ“ í˜„ì¬ ìƒì„± ì¤‘ì¸ ìŠ¬ë¼ì´ë“œ:</h3>
        <div id="slide-content-preview">
            <!-- Content will be populated by JS -->
        </div>
    </div>

    <div class="action-buttons">
        <button id="prev-stage-btn" class="prev-btn">â† ì´ì „ ë‹¨ê³„</button>
        <div>
            <button id="pause-btn" class="pause-btn">â¸ï¸ ì¼ì‹œì •ì§€</button>
            <button id="next-stage-btn" class="next-btn" disabled>â†’ ë‹¤ìŒ ë‹¨ê³„</button>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const TOTAL_SLIDES = 15;
        let currentSlide = 1;
        let estimatedTime = 150; // 2ë¶„ 30ì´ˆ
        let intervalId;
        let isPaused = false;

        const progressElement = document.getElementById('generation-progress');
        const timeElement = document.getElementById('time-remaining');
        const previewElement = document.getElementById('slide-content-preview');
        const pauseBtn = document.getElementById('pause-btn');
        const nextBtn = document.getElementById('next-stage-btn');

        const mockSlideData = {
            "slide_number": 3,
            "type": "Situation",
            "headline": "ì•„ì‹œì•„ ì‹œì¥ì´ 2024-2027ë…„ 50% ì„±ì¥í•˜ì—¬ ìµœëŒ€ ê¸°íšŒ ì œê³µ",
            "insights": [
                "Level 1: 2024ë…„ ì‹œì¥ ê·œëª¨ $100B",
                "Level 2: ì „ë…„ ëŒ€ë¹„ 15% ì„±ì¥, ê¸€ë¡œë²Œ í‰ê·  8% ëŒ€ë¹„ 2ë°°",
                "Level 3: ë””ì§€í„¸ ì „í™˜ì´ ì„±ì¥ì˜ 70% ì£¼ë„",
                "Level 4: ë””ì§€í„¸ ì˜ì—­ íˆ¬ì í™•ëŒ€ë¡œ ì¶”ê°€ 30% ì„±ì¥ ê°€ëŠ¥"
            ],
            "action_items": [
                {
                    "priority": "ìµœìš°ì„ ",
                    "text": "3ê°œ í•µì‹¬ ì‹œì¥ ì§„ì¶œ ê°€ì†í™” (6ê°œì›” ë‚´)"
                },
                {
                    "priority": "í•µì‹¬",
                    "text": "í˜„ì§€ íŒŒíŠ¸ë„ˆì‹­ êµ¬ì¶• 50% í™•ëŒ€"
                }
            ]
        };

        function updateTimer() {
            const minutes = Math.floor(estimatedTime / 60);
            const seconds = estimatedTime % 60;
            timeElement.textContent = `â±ï¸ ì˜ˆìƒ ì‹œê°„: ${minutes}ë¶„ ${seconds.toString().padStart(2, '0')}ì´ˆ ë‚¨ìŒ`;
            if (estimatedTime > 0) {
                estimatedTime--;
            }
        }

        function renderSlide(slideNumber) {
            progressElement.textContent = `ğŸ”„ ìƒì„± ì§„í–‰: Slide ${slideNumber}/${TOTAL_SLIDES}`;
            
            if (slideNumber === mockSlideData.slide_number) {
                previewElement.innerHTML = `
                    <div class="slide-content">
                        <strong>Slide ${mockSlideData.slide_number}: ${mockSlideData.type}</strong>
                        <p class="headline">í—¤ë“œë¼ì¸: "${mockSlideData.headline}"</p>
                        <div class="insights">
                            <strong>ì¸ì‚¬ì´íŠ¸:</strong>
                            <ul>${mockSlideData.insights.map(item => `<li>â€¢ ${item}</li>`).join('')}</ul>
                        </div>
                        <div class="actions">
                            <strong>ì•¡ì…˜ ì•„ì´í…œ:</strong>
                            <ul>${mockSlideData.action_items.map(item => `<li><span class="priority-high">[${item.priority}]</span> ${item.text}</li>`).join('')}</ul>
                        </div>
                    </div>
                `;
            } else {
                previewElement.innerHTML = `
                    <div class="slide-content">
                        <strong>Slide ${slideNumber}: ìƒì„± ì¤‘...</strong>
                        <p>í—¤ë“œë¼ì¸, ì¸ì‚¬ì´íŠ¸, ì•¡ì…˜ ì•„ì´í…œì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                `;
            }
        }

        function startGeneration() {
            intervalId = setInterval(() => {
                if (currentSlide > TOTAL_SLIDES) {
                    clearInterval(intervalId);
                    progressElement.textContent = `âœ… ìƒì„± ì™„ë£Œ: ${TOTAL_SLIDES}/${TOTAL_SLIDES}`;
                    nextBtn.disabled = false;
                    pauseBtn.disabled = true;
                    pauseBtn.textContent = "âœ“ ì™„ë£Œ";
                    return;
                }
                renderSlide(currentSlide);
                updateTimer();
                currentSlide++;
            }, 1000);
        }

        pauseBtn.addEventListener('click', () => {
            isPaused = !isPaused;
            if (isPaused) {
                clearInterval(intervalId);
                pauseBtn.textContent = 'â–¶ï¸ ê³„ì†';
                pauseBtn.style.backgroundColor = '#40a9ff';
            } else {
                startGeneration();
                pauseBtn.textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
                pauseBtn.style.backgroundColor = '#faad14';
            }
        });

        document.getElementById('prev-stage-btn').addEventListener('click', () => {
            window.location.href = 'stage2_ui.html';
        });
        
        nextBtn.addEventListener('click', () => {
            alert('ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.');
        });

        // Start the process
        startGeneration();
    });
</script>

</body>
</html>
