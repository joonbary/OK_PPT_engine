ğŸ“ ì‘ì—…ì§€ì‹œì„œ #6: FastAPI REST API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„
ğŸ¯ ëª©í‘œ
í˜„ì¬ Python ìŠ¤í¬ë¦½íŠ¸ë¡œë§Œ ë™ì‘í•˜ëŠ” ì‹œìŠ¤í…œì„ ì‹¤ì œ ì„œë¹„ìŠ¤ë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ REST API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„
ğŸ“Š ì˜ˆìƒ ì‘ì—… ì‹œê°„

ì†Œìš” ì‹œê°„: 3-4ì‹œê°„
ë‚œì´ë„: ì¤‘ê°„

ğŸ› ï¸ êµ¬í˜„í•  API ì—”ë“œí¬ì¸íŠ¸
1. POST /api/v1/generate-ppt - PPT ìƒì„± ì‹œì‘
pythonRequest Body:
{
  "document": "ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì„œ ë‚´ìš©...",
  "style": "mckinsey",
  "target_audience": "executive",
  "num_slides": 12,
  "language": "ko"
}

Response:
{
  "ppt_id": "uuid-123-456",
  "status": "processing",
  "estimated_time": 5,
  "created_at": "2025-01-02T10:00:00Z"
}
2. GET /api/v1/ppt-status/{ppt_id} - ìƒì„± ìƒíƒœ ì¡°íšŒ
pythonResponse:
{
  "ppt_id": "uuid-123-456",
  "status": "completed",  // processing, completed, failed
  "progress": 100,
  "current_stage": "quality_review",
  "quality_score": 0.873,
  "download_url": "/api/v1/download/uuid-123-456",
  "created_at": "2025-01-02T10:00:00Z",
  "completed_at": "2025-01-02T10:00:05Z"
}
3. GET /api/v1/download/{ppt_id} - PPT íŒŒì¼ ë‹¤ìš´ë¡œë“œ
pythonResponse: 
- Content-Type: application/vnd.openxmlformats-officedocument.presentationml.presentation
- ì‹¤ì œ PPTX íŒŒì¼ ìŠ¤íŠ¸ë¦¬ë°
4. DELETE /api/v1/ppt/{ppt_id} - ìƒì„±ëœ PPT ì‚­ì œ
pythonResponse:
{
  "success": true,
  "message": "PPT íŒŒì¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."
}
5. GET /api/v1/health - í—¬ìŠ¤ ì²´í¬
pythonResponse:
{
  "status": "healthy",
  "version": "1.0.0",
  "redis": "connected",
  "llm_api": "available"
}

ğŸ“ ìƒì„±/ìˆ˜ì •í•  íŒŒì¼ ëª©ë¡
1. app/api/v1/endpoints/ppt.py (ì‹ ê·œ - ì•½ 200ì¤„)
python"""PPT ìƒì„± API ì—”ë“œí¬ì¸íŠ¸"""
from fastapi import APIRouter, HTTPException, BackgroundTasks
from app.models.schemas import PPTRequest, PPTResponse, StatusResponse
from app.services.ppt_service import PPTService
from app.core.dependencies import get_redis_client

router = APIRouter()

@router.post("/generate-ppt", response_model=PPTResponse)
async def generate_ppt(
    request: PPTRequest,
    background_tasks: BackgroundTasks
):
    """PPT ìƒì„± ìš”ì²­"""
    # 1. ìš”ì²­ ê²€ì¦
    # 2. ppt_id ìƒì„±
    # 3. ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ì‹œì‘
    # 4. ì´ˆê¸° ì‘ë‹µ ë°˜í™˜
    pass

@router.get("/ppt-status/{ppt_id}", response_model=StatusResponse)
async def get_ppt_status(ppt_id: str):
    """PPT ìƒì„± ìƒíƒœ ì¡°íšŒ"""
    # Redisì—ì„œ ìƒíƒœ ì¡°íšŒ
    pass

@router.get("/download/{ppt_id}")
async def download_ppt(ppt_id: str):
    """PPT íŒŒì¼ ë‹¤ìš´ë¡œë“œ"""
    # FileResponseë¡œ PPTX ë°˜í™˜
    pass
2. app/models/schemas.py (ì‹ ê·œ - ì•½ 100ì¤„)
python"""Pydantic ìŠ¤í‚¤ë§ˆ ì •ì˜"""
from pydantic import BaseModel, Field
from typing import Optional
from datetime import datetime

class PPTRequest(BaseModel):
    document: str = Field(..., min_length=100, description="ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì„œ ë‚´ìš©")
    style: str = Field(default="mckinsey", description="PPT ìŠ¤íƒ€ì¼")
    target_audience: str = Field(default="executive", description="íƒ€ê²Ÿ ì²­ì¤‘")
    num_slides: int = Field(default=12, ge=5, le=30, description="ìŠ¬ë¼ì´ë“œ ìˆ˜")
    language: str = Field(default="ko", description="ì–¸ì–´")

class PPTResponse(BaseModel):
    ppt_id: str
    status: str
    estimated_time: int
    created_at: datetime
    
class StatusResponse(BaseModel):
    ppt_id: str
    status: str
    progress: int
    current_stage: Optional[str]
    quality_score: Optional[float]
    download_url: Optional[str]
    created_at: datetime
    completed_at: Optional[datetime]
3. app/services/ppt_service.py (ì‹ ê·œ - ì•½ 150ì¤„)
python"""PPT ìƒì„± ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§"""
import uuid
from datetime import datetime
from app.services.workflow_orchestrator import WorkflowOrchestrator
from app.core.redis_client import RedisClient

class PPTService:
    def __init__(self):
        self.redis = RedisClient()
        self.orchestrator = WorkflowOrchestrator()
    
    def create_ppt_id(self) -> str:
        """ê³ ìœ  PPT ID ìƒì„±"""
        return str(uuid.uuid4())
    
    async def start_generation(self, ppt_id: str, request: dict):
        """ë°±ê·¸ë¼ìš´ë“œ PPT ìƒì„± ì‹œì‘"""
        try:
            # 1. ìƒíƒœë¥¼ processingìœ¼ë¡œ ì„¤ì •
            await self.update_status(ppt_id, "processing", 0, "document_analysis")
            
            # 2. WorkflowOrchestrator ì‹¤í–‰
            result = await self.orchestrator.generate_presentation(
                document_text=request["document"],
                target_audience=request["target_audience"]
            )
            
            # 3. íŒŒì¼ ì €ì¥
            file_path = await self.save_pptx(ppt_id, result["pptx_file"])
            
            # 4. ìƒíƒœ ì—…ë°ì´íŠ¸
            await self.update_status(
                ppt_id, "completed", 100, 
                quality_score=result["quality_score"],
                file_path=file_path
            )
            
        except Exception as e:
            await self.update_status(ppt_id, "failed", 0, error=str(e))
    
    async def get_status(self, ppt_id: str) -> dict:
        """PPT ìƒì„± ìƒíƒœ ì¡°íšŒ"""
        # Redisì—ì„œ ìƒíƒœ ê°€ì ¸ì˜¤ê¸°
        pass
    
    async def get_file_path(self, ppt_id: str) -> str:
        """PPT íŒŒì¼ ê²½ë¡œ ì¡°íšŒ"""
        # Redisì—ì„œ íŒŒì¼ ê²½ë¡œ ê°€ì ¸ì˜¤ê¸°
        pass
4. app/core/redis_client.py (ì‹ ê·œ - ì•½ 80ì¤„)
python"""Redis í´ë¼ì´ì–¸íŠ¸"""
import redis
import json
from typing import Optional

class RedisClient:
    def __init__(self):
        self.redis = redis.Redis(
            host='redis',
            port=6379,
            decode_responses=True
        )
    
    async def set_ppt_status(self, ppt_id: str, data: dict, ttl: int = 86400):
        """PPT ìƒíƒœ ì €ì¥ (TTL 24ì‹œê°„)"""
        self.redis.setex(
            f"ppt:{ppt_id}",
            ttl,
            json.dumps(data)
        )
    
    async def get_ppt_status(self, ppt_id: str) -> Optional[dict]:
        """PPT ìƒíƒœ ì¡°íšŒ"""
        data = self.redis.get(f"ppt:{ppt_id}")
        return json.loads(data) if data else None
5. app/main.py (ìˆ˜ì • - ì•½ 50ì¤„ ì¶”ê°€)
python"""FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜ ë©”ì¸"""
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from app.api.v1.endpoints import ppt

app = FastAPI(
    title="McKinsey PPT Generator API",
    version="1.0.0",
    description="McKinsey ìˆ˜ì¤€ PPT ìë™ ìƒì„± ì‹œìŠ¤í…œ"
)

# CORS ì„¤ì •
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# API ë¼ìš°í„° ë“±ë¡
app.include_router(
    ppt.router,
    prefix="/api/v1",
    tags=["ppt"]
)

@app.get("/")
async def root():
    return {
        "message": "McKinsey PPT Generator API",
        "version": "1.0.0",
        "docs_url": "/docs"
    }

@app.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "version": "1.0.0"
    }

âœ… ê²€ì¦ ê¸°ì¤€
1. API ë™ì‘ í™•ì¸
bash# í—¬ìŠ¤ ì²´í¬
curl http://localhost:8000/health

# PPT ìƒì„± ìš”ì²­
curl -X POST http://localhost:8000/api/v1/generate-ppt \
  -H "Content-Type: application/json" \
  -d '{
    "document": "2024ë…„ ë§¤ì¶œì´ 1000ì–µì›ìœ¼ë¡œ ì „ë…„ ëŒ€ë¹„ 20% ì¦ê°€í–ˆìŠµë‹ˆë‹¤...",
    "num_slides": 12
  }'

# ìƒíƒœ ì¡°íšŒ
curl http://localhost:8000/api/v1/ppt-status/{ppt_id}

# íŒŒì¼ ë‹¤ìš´ë¡œë“œ
curl http://localhost:8000/api/v1/download/{ppt_id} -o output.pptx
```

#### 2. **Swagger UI í™•ì¸**
- http://localhost:8000/docs ì ‘ì†
- ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

#### 3. **ì„±ëŠ¥ ê²€ì¦**
- ë™ì‹œ ìš”ì²­ 10ê°œ ì²˜ë¦¬ ê°€ëŠ¥
- ì‘ë‹µ ì‹œê°„ < 200ms (ìƒíƒœ ì¡°íšŒ)
- ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ì •ìƒ ë™ì‘

---

### ğŸ¯ ì„±ê³µ ì§€í‘œ

- [ ] 5ê°œ API ì—”ë“œí¬ì¸íŠ¸ ëª¨ë‘ ì •ìƒ ë™ì‘
- [ ] Swagger UIì—ì„œ í…ŒìŠ¤íŠ¸ ì„±ê³µ
- [ ] Redis ìƒíƒœ ê´€ë¦¬ ì •ìƒ ë™ì‘
- [ ] PPT íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì„±ê³µ
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° ê²€ì¦ ì™„ë£Œ

---

## ğŸ’¬ Claude Codeì—ê²Œ ì „ë‹¬í•  ë©”ì‹œì§€
```
ì•ˆë…•! ë‚˜ëŠ” ì§€ê¸ˆ McKinsey ìˆ˜ì¤€ PPT ìë™ ìƒì„± ì‹œìŠ¤í…œì„ ê°œë°œí•˜ê³  ìˆì–´.

ğŸ“Š í˜„ì¬ ìƒíƒœ:
- í”„ë¡œì íŠ¸ ê²½ë¡œ: D:\PPT_Designer_OK\mckinsey-ppt-generator
- í•µì‹¬ ê¸°ëŠ¥: ì´ë¯¸ ì™„ì„±ë¨ (í’ˆì§ˆ 0.873, ìƒì„± 3ì´ˆ)
- í˜„ì¬ ë¬¸ì œ: Python ìŠ¤í¬ë¦½íŠ¸ë¡œë§Œ ì‹¤í–‰ ê°€ëŠ¥

ğŸ¯ ì´ë²ˆ ì‘ì—… ëª©í‘œ:
ì‹¤ì œ ì„œë¹„ìŠ¤ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ **FastAPI REST API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„**

ğŸ“ êµ¬í˜„í•  ë‚´ìš©:
1. POST /api/v1/generate-ppt - PPT ìƒì„± ì‹œì‘
2. GET /api/v1/ppt-status/{ppt_id} - ìƒíƒœ ì¡°íšŒ
3. GET /api/v1/download/{ppt_id} - íŒŒì¼ ë‹¤ìš´ë¡œë“œ
4. DELETE /api/v1/ppt/{ppt_id} - íŒŒì¼ ì‚­ì œ
5. GET /api/v1/health - í—¬ìŠ¤ ì²´í¬

ğŸ“ ìƒì„±í•  íŒŒì¼:
- app/api/v1/endpoints/ppt.py (200ì¤„)
- app/models/schemas.py (100ì¤„)
- app/services/ppt_service.py (150ì¤„)
- app/core/redis_client.py (80ì¤„)
- app/main.py ìˆ˜ì • (50ì¤„ ì¶”ê°€)

âœ… ê²€ì¦ ë°©ë²•:
- http://localhost:8000/docs ì—ì„œ Swagger UI í™•ì¸
- curl ëª…ë ¹ì–´ë¡œ API í…ŒìŠ¤íŠ¸
- ì‹¤ì œ PPT íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì„±ê³µ

ìœ„ ë‚´ìš©ì„ ì°¸ê³ í•´ì„œ FastAPI REST APIë¥¼ êµ¬í˜„í•´ì¤˜!
ê¸°ì¡´ WorkflowOrchestratorëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê³ , API ë ˆì´ì–´ë§Œ ì¶”ê°€í•˜ë©´ ë¼.