ğŸ—ï¸ Phase 2: ì½˜í…ì¸  ì°¨ë³„í™” ì‹œìŠ¤í…œ (Content Differentiation)
Task 2.1: MECE êµ¬ì¡° ê¸°ë°˜ ìŠ¬ë¼ì´ë“œ ë¶„í• 
ìš°ì„ ìˆœìœ„: ğŸ”´ P0
ë¬¸ì œ ì§„ë‹¨
í˜„ì¬ 2-5ë²ˆ ìŠ¬ë¼ì´ë“œê°€ ëª¨ë‘ ë¹„ìŠ·í•œ ë‚´ìš©ì„ ë°˜ë³µí•¨:

Executive Summary: "AIëŠ” ê¸°ì—…ì„ ì¬êµ¬ì„±í•œë‹¤"
Market Analysis: "AIëŠ” ê¸°ì—…ì„ ì¬êµ¬ì„±í•œë‹¤"
Strategic Options: "AIëŠ” ê¸°ì—…ì„ ì¬êµ¬ì„±í•  ê²ƒ"
Recommendations: "AIëŠ” ê¸°ì—…ì„ ì¬êµ¬ì„±í•œë‹¤"

ê·¼ë³¸ ì›ì¸
StrategistAgentê°€ ë¬¸ì„œë¥¼ MECE êµ¬ì¡°ë¡œ ë¶„í•´í•˜ì§€ ì•Šê³ , ê° ìŠ¬ë¼ì´ë“œì— ì „ì²´ ìš”ì•½ë§Œ í• ë‹¹í•˜ê³  ìˆìŒ
ì‘ì—… ë‚´ìš©
1ë‹¨ê³„: app/agents/strategist_agent.py ëŒ€í­ ìˆ˜ì •
pythonclass StrategistAgent(BaseAgent):
    """
    ì „ëµ êµ¬ì¡° ì„¤ê³„ ì—ì´ì „íŠ¸
    MECE ì›ì¹™ìœ¼ë¡œ ë¬¸ì„œë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ë¶„í• 
    """
    
    async def process(self, input_data: Dict, context: Dict) -> Dict:
        document = input_data['document']
        num_slides = input_data.get('num_slides', 5)
        
        # âœ… 1. ë¬¸ì„œ ì „ì²´ ë¶„ì„
        analysis = await self._analyze_document(document)
        
        # âœ… 2. MECE í”„ë ˆì„ì›Œí¬ ì„ íƒ
        framework = self._select_mece_framework(analysis)
        
        # âœ… 3. ë¬¸ì„œë¥¼ MECE êµ¬ì¡°ë¡œ ë¶„í•´
        mece_segments = self._decompose_by_mece(document, framework, analysis)
        
        # âœ… 4. ê° ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ìŠ¬ë¼ì´ë“œì— ë§¤í•‘
        slide_mapping = self._map_segments_to_slides(mece_segments, num_slides)
        
        return {
            "analysis": analysis,
            "framework": framework,
            "mece_segments": mece_segments,
            "slide_outline": slide_mapping
        }
    
    def _decompose_by_mece(self, document: str, framework: str, analysis: Dict) -> List[Dict]:
        """
        MECE ì›ì¹™ìœ¼ë¡œ ë¬¸ì„œ ë¶„í•´
        
        ì˜ˆì‹œ (3C í”„ë ˆì„ì›Œí¬):
        - Segment 1: Company (ê¸°ì—… í˜„í™©)
        - Segment 2: Competitors (ê²½ìŸ í™˜ê²½)
        - Segment 3: Customers (ê³ ê°/ì‹œì¥)
        """
        
        mece_prompts = {
            "3C": """
            ë‹¤ìŒ ë¬¸ì„œë¥¼ 3C í”„ë ˆì„ì›Œí¬(Company, Competitors, Customers)ë¡œ ë¶„ì„í•˜ì—¬
            ê° ì˜ì—­ì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ì„ **ì™„ì „íˆ ë¶„ë¦¬**í•˜ì—¬ ì¶”ì¶œí•˜ì„¸ìš”:
            
            ë¬¸ì„œ:
            {document}
            
            JSON í˜•ì‹ìœ¼ë¡œ ë°˜í™˜:
            {{
                "Company": "ê¸°ì—… ìì²´ì— ëŒ€í•œ ë‚´ìš© (ë‚´ë¶€ ì—­ëŸ‰, ì¡°ì§, ìš´ì˜)",
                "Competitors": "ê²½ìŸ í™˜ê²½ì— ëŒ€í•œ ë‚´ìš© (ê²½ìŸì‚¬, ì‹œì¥ ì ìœ ìœ¨)",
                "Customers": "ê³ ê°/ì‹œì¥ì— ëŒ€í•œ ë‚´ìš© (ìˆ˜ìš”, íŠ¸ë Œë“œ, ë‹ˆì¦ˆ)"
            }}
            
            â—ì¤‘ìš”: ê° ì˜ì—­ì€ ìƒí˜¸ ë°°íƒ€ì ì´ê³  ì™„ì „íˆ ë¶„ë¦¬ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
            """,
            
            "SWOT": """
            ë‹¤ìŒ ë¬¸ì„œë¥¼ SWOT ë¶„ì„ìœ¼ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”:
            
            {document}
            
            JSON í˜•ì‹:
            {{
                "Strengths": "ê°•ì  (ë‚´ë¶€ ê¸ì • ìš”ì¸)",
                "Weaknesses": "ì•½ì  (ë‚´ë¶€ ë¶€ì • ìš”ì¸)",
                "Opportunities": "ê¸°íšŒ (ì™¸ë¶€ ê¸ì • ìš”ì¸)",
                "Threats": "ìœ„í˜‘ (ì™¸ë¶€ ë¶€ì • ìš”ì¸)"
            }}
            """,
            
            "Problem-Solution": """
            ë‹¤ìŒ ë¬¸ì„œë¥¼ Problem-Solution êµ¬ì¡°ë¡œ ë¶„ì„:
            
            {document}
            
            JSON í˜•ì‹:
            {{
                "Current_State": "í˜„ì¬ ìƒí™© (As-Is)",
                "Problems": "ë¬¸ì œì /ê³¼ì œ",
                "Solutions": "í•´ê²°ë°©ì•ˆ",
                "Expected_Outcomes": "ê¸°ëŒ€ íš¨ê³¼ (To-Be)"
            }}
            """
        }
        
        # LLMì— MECE ë¶„í•´ ìš”ì²­
        prompt = mece_prompts[framework].format(document=document)
        response = await self.llm_client.generate(prompt)
        segments = json.loads(response)
        
        return [
            {"category": key, "content": value}
            for key, value in segments.items()
        ]
    
    def _map_segments_to_slides(self, mece_segments: List[Dict], num_slides: int) -> List[Dict]:
        """
        MECE ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ìŠ¬ë¼ì´ë“œì— ë§¤í•‘
        
        5ì¥ êµ¬ì„± ì˜ˆì‹œ:
        1. Title
        2. Executive Summary (ì „ì²´ ê°œìš”)
        3-4. MECE ì„¸ê·¸ë¨¼íŠ¸ ê°ê° (Market Analysis, Strategic Options ë“±)
        5. Recommendations (ì¢…í•© ì œì–¸)
        """
        
        slide_outline = []
        
        # 1. í‘œì§€
        slide_outline.append({
            "slide_number": 1,
            "type": "Title",
            "content_focus": "ì „ì²´ ì£¼ì œ",
            "mece_segment": None
        })
        
        # 2. Executive Summary
        slide_outline.append({
            "slide_number": 2,
            "type": "Executive Summary",
            "content_focus": "ì „ì²´ ë¬¸ì„œ ìš”ì•½ (ëª¨ë“  MECE ì„¸ê·¸ë¨¼íŠ¸ì˜ í•µì‹¬)",
            "mece_segment": "ALL"
        })
        
        # 3-4. MECE ì„¸ê·¸ë¨¼íŠ¸ í• ë‹¹
        content_slides = num_slides - 3  # í‘œì§€, ìš”ì•½, ì œì–¸ ì œì™¸
        for idx, segment in enumerate(mece_segments[:content_slides]):
            slide_outline.append({
                "slide_number": 3 + idx,
                "type": self._determine_slide_type(segment["category"]),
                "content_focus": segment["category"],
                "mece_segment": segment["content"],  # âœ… íŠ¹ì • ì„¸ê·¸ë¨¼íŠ¸ë§Œ í• ë‹¹
                "instructions": f"ì´ ìŠ¬ë¼ì´ë“œëŠ” **{segment['category']}**ì— ê´€í•œ ë‚´ìš©ë§Œ ë‹¤ë£¨ì„¸ìš”."
            })
        
        # 5. Recommendations
        slide_outline.append({
            "slide_number": num_slides,
            "type": "Recommendations",
            "content_focus": "ì¢…í•© ì œì–¸ ë° ì•¡ì…˜ ì•„ì´í…œ",
            "mece_segment": "ALL"
        })
        
        return slide_outline
    
    def _determine_slide_type(self, category: str) -> str:
        """MECE ì¹´í…Œê³ ë¦¬ì— ë§ëŠ” ìŠ¬ë¼ì´ë“œ íƒ€ì… ê²°ì •"""
        type_mapping = {
            "Company": "Internal Analysis",
            "Competitors": "Market Analysis",
            "Customers": "Market Analysis",
            "Strengths": "Internal Analysis",
            "Weaknesses": "Challenges",
            "Opportunities": "Market Analysis",
            "Threats": "Market Analysis",
            "Current_State": "Situation Analysis",
            "Problems": "Problem Definition",
            "Solutions": "Strategic Options",
            "Expected_Outcomes": "Impact Analysis"
        }
        return type_mapping.get(category, "Analysis")
2ë‹¨ê³„: ContentGenerator ìˆ˜ì •í•˜ì—¬ MECE ì„¸ê·¸ë¨¼íŠ¸ í™œìš©
python# app/services/content_generator.py
class ContentGenerator:
    async def generate_slide_content(self, slide_outline: Dict, context: Dict) -> Dict:
        slide_type = slide_outline["type"]
        mece_segment = slide_outline.get("mece_segment")
        
        # âœ… MECE ì„¸ê·¸ë¨¼íŠ¸ê°€ íŠ¹ì •ë˜ì–´ ìˆìœ¼ë©´ í•´ë‹¹ ë‚´ìš©ë§Œ ì‚¬ìš©
        if mece_segment and mece_segment != "ALL":
            prompt = f"""
            ìŠ¬ë¼ì´ë“œ ìœ í˜•: {slide_type}
            ì½˜í…ì¸  ë²”ìœ„: {slide_outline['content_focus']}
            
            â—ì¤‘ìš”: ë‹¤ìŒ ì½˜í…ì¸ ì— **ì˜¤ì§ ì§‘ì¤‘**í•˜ì„¸ìš”:
            {mece_segment}
            
            ë‹¤ë¥¸ ì£¼ì œëŠ” ì–¸ê¸‰í•˜ì§€ ë§ˆì„¸ìš”. ìœ„ ë‚´ìš©ë§Œ ê¹Šì´ ìˆê²Œ ë‹¤ë£¨ì„¸ìš”.
            
            ìƒì„± ìš”êµ¬ì‚¬í•­:
            - í—¤ë“œë¼ì¸: ì´ ì„¸ê·¸ë¨¼íŠ¸ì˜ í•µì‹¬ ë©”ì‹œì§€ (So What?)
            - 3-5ê°œ ë¶ˆë¦¿ í¬ì¸íŠ¸: ì„¸ë¶€ ì¸ì‚¬ì´íŠ¸
            - ë°ì´í„°/ì˜ˆì‹œ í¬í•¨
            """
        else:
            # Executive Summaryë‚˜ RecommendationsëŠ” ì „ì²´ í†µí•©
            prompt = f"""
            ìŠ¬ë¼ì´ë“œ ìœ í˜•: {slide_type}
            
            ì „ì²´ MECE ì„¸ê·¸ë¨¼íŠ¸:
            {json.dumps(context.get('mece_segments', []), ensure_ascii=False)}
            
            ëª¨ë“  ì„¸ê·¸ë¨¼íŠ¸ë¥¼ **ì¢…í•©**í•˜ì—¬ {slide_type}ì„ ì‘ì„±í•˜ì„¸ìš”.
            """
        
        return await self._generate_from_prompt(prompt)
ê²€ì¦ ë°©ë²•
python# tests/test_mece_decomposition.py
def test_mece_differentiation():
    strategist = StrategistAgent()
    
    result = strategist.process({
        "document": "AI ê¸°ì—… ì˜í–¥ ë¬¸ì„œ...",
        "num_slides": 5
    })
    
    slide_outline = result["slide_outline"]
    
    # ê²€ì¦ 1: ê° ìŠ¬ë¼ì´ë“œê°€ ë‹¤ë¥¸ mece_segmentë¥¼ ê°€ì§
    content_slides = [s for s in slide_outline if s["slide_number"] in [3, 4]]
    segments = [s["mece_segment"] for s in content_slides]
    assert len(segments) == len(set(segments))  # ì¤‘ë³µ ì—†ìŒ
    
    # ê²€ì¦ 2: ì‹¤ì œ ì½˜í…ì¸  ìƒì„± í›„ ìœ ì‚¬ë„ í™•ì¸
    contents = [await generate_content(s) for s in content_slides]
    similarity = calculate_similarity(contents[0], contents[1])
    assert similarity < 0.5  # 50% ì´í•˜ ìœ ì‚¬ë„

Task 2.2: ìŠ¬ë¼ì´ë“œ íƒ€ì…ë³„ í…œí”Œë¦¿ ë‹¤ì–‘í™”
ìš°ì„ ìˆœìœ„: ğŸŸ¡ P1
ì‘ì—… ë‚´ìš©
app/services/design_applicator.py ìˆ˜ì •
pythonclass DesignApplicator:
    """
    ìŠ¬ë¼ì´ë“œ íƒ€ì…ë³„ë¡œ ë‹¤ë¥¸ ë ˆì´ì•„ì›ƒ ì ìš©
    """
    
    SLIDE_TYPE_LAYOUTS = {
        "Title": "title_slide",
        "Executive Summary": "dual_header",  # ìƒë‹¨ í—¤ë“œë¼ì¸ + í•˜ë‹¨ í‚¤ í¬ì¸íŠ¸
        "Market Analysis": "three_column",   # 3ë‹¨ êµ¬ì¡°
        "Strategic Options": "matrix",       # 2x2 ë§¤íŠ¸ë¦­ìŠ¤
        "Recommendations": "action_list",    # ì•¡ì…˜ ì•„ì´í…œ ë¦¬ìŠ¤íŠ¸
        "Internal Analysis": "dual_header",
        "Challenges": "problem_list",
        "Impact Analysis": "waterfall"       # íë¦„ë„
    }
    
    def apply_design(self, slides: List[Dict], context: Dict) -> Presentation:
        prs = Presentation()
        
        for slide_data in slides:
            slide_type = slide_data["type"]
            
            # âœ… íƒ€ì…ë³„ ë ˆì´ì•„ì›ƒ ì„ íƒ
            layout_name = self.SLIDE_TYPE_LAYOUTS.get(slide_type, "dual_header")
            layout = self._get_layout(prs, layout_name)
            
            # âœ… ë ˆì´ì•„ì›ƒì— ë§ëŠ” ì½˜í…ì¸  ë°°ì¹˜
            if layout_name == "three_column":
                self._apply_three_column_layout(slide, slide_data)
            elif layout_name == "matrix":
                self._apply_matrix_layout(slide, slide_data)
            else:
                self._apply_default_layout(slide, slide_data)
        
        return prs
    
    def _apply_three_column_layout(self, slide, data):
        """
        3ë‹¨ ë ˆì´ì•„ì›ƒ ì ìš©
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚       Headline (full width)  â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Column 1 â”‚ Column 2 â”‚ Col 3  â”‚
        â”‚ â€¢ Point  â”‚ â€¢ Point  â”‚ â€¢ Pt   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        """
        # êµ¬í˜„...
    
    def _apply_matrix_layout(self, slide, data):
        """
        2x2 ë§¤íŠ¸ë¦­ìŠ¤ ë ˆì´ì•„ì›ƒ
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚       Headline               â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ High Impact  â”‚ Quick Wins    â”‚
        â”‚ High Effort  â”‚ Low Effort    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Low Priority â”‚ Low Impact    â”‚
        â”‚              â”‚               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        """
        # êµ¬í˜„...
```

---

## ğŸ“‹ **ìµœì¢… ì‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸ (for Claude Code)**

### **Phase 1: ê¸´ê¸‰ ìˆ˜ì • (ì´ë²ˆ ì„¸ì…˜)**
```
â–¡ Task 1.1: ì–¸ì–´ ì²˜ë¦¬ ì‹œìŠ¤í…œ
  â–¡ ContentGeneratorì— language íŒŒë¼ë¯¸í„° ì¶”ê°€
  â–¡ ëª¨ë“  Agentì— ì–¸ì–´ ì „ë‹¬
  â–¡ LLM í”„ë¡¬í”„íŠ¸ì— ì–¸ì–´ ëª…ì‹œ
  â–¡ í…ŒìŠ¤íŠ¸: í•œê¸€ ì œëª© ìƒì„± í™•ì¸

â–¡ Task 1.2: ë¶ˆë¦¿ í¬ì¸íŠ¸ ì¸ì½”ë”©
  â–¡ UTF-8 ì¸ì½”ë”© ëª…ì‹œ
  â–¡ ë¶ˆë¦¿ ë¬¸ì "â€¢" ëª…ì‹œì  ì„¤ì •
  â–¡ í…ŒìŠ¤íŠ¸: "??" ë¬¸ì ì‚¬ë¼ì§ í™•ì¸

â–¡ Task 1.3: ìŒìŠ´ì²´ ë³€í™˜
  â–¡ EumsumStyleConverter í´ë˜ìŠ¤ ìƒì„±
  â–¡ ContentGeneratorì— í†µí•©
  â–¡ í…ŒìŠ¤íŠ¸: ìŒìŠ´ì²´ ë³€í™˜ í™•ì¸
```

### **Phase 2: ì½˜í…ì¸  ì°¨ë³„í™” (ë‹¤ìŒ ì„¸ì…˜)**
```
â–¡ Task 2.1: MECE êµ¬ì¡° ë¶„í•´
  â–¡ StrategistAgent._decompose_by_mece() êµ¬í˜„
  â–¡ _map_segments_to_slides() êµ¬í˜„
  â–¡ ContentGeneratorì— MECE ì„¸ê·¸ë¨¼íŠ¸ í™œìš©
  â–¡ í…ŒìŠ¤íŠ¸: ìŠ¬ë¼ì´ë“œ ë‚´ìš© ì°¨ë³„í™” í™•ì¸

â–¡ Task 2.2: í…œí”Œë¦¿ ë‹¤ì–‘í™”
  â–¡ DesignApplicator ë ˆì´ì•„ì›ƒ ë§µí•‘
  â–¡ 3-column, matrix ë ˆì´ì•„ì›ƒ êµ¬í˜„
  â–¡ í…ŒìŠ¤íŠ¸: ë‹¤ì–‘í•œ ë ˆì´ì•„ì›ƒ ì ìš© í™•ì¸
```

---

## ğŸ¯ **í´ë¡œë“œ ì½”ë“œì—ê²Œ ì „ë‹¬í•  ìµœì¢… ì§€ì‹œì‚¬í•­**
```
===== ì‘ì—… ì‹œì‘ =====

í”„ë¡œì íŠ¸: McKinsey PPT ìë™ ìƒì„± ì‹œìŠ¤í…œ
ê²½ë¡œ: D:\PPT_Designer_OK

í˜„ì¬ ë¬¸ì œ:
1. í•œê¸€ ë¬¸ì„œì¸ë° ì˜ì–´ ì œëª© ìƒì„±ë¨
2. ë¶ˆë¦¿ í¬ì¸íŠ¸ê°€ "??" ê¸°í˜¸ë¡œ ê¹¨ì§
3. 2-5í˜ì´ì§€ ë‚´ìš©ì´ ëª¨ë‘ ë¹„ìŠ·í•¨
4. ì„œìˆ ì²´ (ìŒìŠ´ì²´ ì•„ë‹˜)
5. ëª¨ë“  ìŠ¬ë¼ì´ë“œê°€ ê°™ì€ í…œí”Œë¦¿

ìš°ì„ ìˆœìœ„ ì‘ì—… (Phase 1):

[P0-1] ì–¸ì–´ ì²˜ë¦¬ ìˆ˜ì •
- app/services/content_generator.py
  â†’ __init__(self, language="ko") ì¶”ê°€
  â†’ LLM í”„ë¡¬í”„íŠ¸ì— ì–¸ì–´ ì§€ì‹œ ì¶”ê°€
  
[P0-2] ë¶ˆë¦¿ í¬ì¸íŠ¸ ì¸ì½”ë”©
- app/services/design_applicator.py
  â†’ _apply_bullet_points() UTF-8 ëª…ì‹œ
  â†’ ë¶ˆë¦¿ ë¬¸ìë¥¼ "â€¢"ë¡œ ëª…ì‹œ

[P1-3] ìŒìŠ´ì²´ ë³€í™˜
- app/utils/text_formatter.py ìƒˆ íŒŒì¼ ìƒì„±
  â†’ EumsumStyleConverter í´ë˜ìŠ¤ êµ¬í˜„
  â†’ ì •ê·œì‹ ê·œì¹™ 9ê°œ ì ìš©
- ContentGeneratorì— í†µí•©

í…ŒìŠ¤íŠ¸ ë°©ë²•:
python examples/test_fixed_issues.py

ì˜ˆìƒ ê²°ê³¼:
âœ… ì œëª©ì´ í•œê¸€ë¡œ ìƒì„±
âœ… ë¶ˆë¦¿ í¬ì¸íŠ¸ ì •ìƒ í‘œì‹œ
âœ… ìŒìŠ´ì²´ ì ìš©ë¨

ì™„ë£Œ í›„ ë¦¬í¬íŠ¸:
- ìˆ˜ì •í•œ íŒŒì¼ ëª©ë¡
- í…ŒìŠ¤íŠ¸ ê²°ê³¼
- ë‹¤ìŒ Phase 2 ì¤€ë¹„ ìƒíƒœ