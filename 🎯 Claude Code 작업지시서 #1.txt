ğŸ¯ Claude Code ì‘ì—…ì§€ì‹œì„œ #1
í’ˆì§ˆ ì ìˆ˜ 0.503 â†’ 0.85+ ê°œì„  ì‘ì—…
ğŸ“‹ ì‘ì—… ê°œìš”

ëª©ì : PPT ìƒì„± í’ˆì§ˆ ê°œì„  (íƒ€ì´í‹€, ì°¨íŠ¸, ìŠ¤íƒ€ì¼ ì ìš©)
ì˜ˆìƒ ì†Œìš”ì‹œê°„: 2-3ì‹œê°„
ë‚œì´ë„: ì¤‘ê¸‰
ì˜í–¥ ë²”ìœ„: 3ê°œ íŒŒì¼ ìˆ˜ì •


ğŸ”¥ Priority 1: íƒ€ì´í‹€ ì¶”ê°€ (ìµœìš°ì„ )
íŒŒì¼: app/services/pptx_generator.py
í˜„ì¬ ë¬¸ì œ
python# ëª¨ë“  ìŠ¬ë¼ì´ë“œê°€ Blank ë ˆì´ì•„ì›ƒìœ¼ë¡œ ìƒì„±ë˜ì–´ íƒ€ì´í‹€ placeholderê°€ ì—†ìŒ
# ê²°ê³¼: 11ì¥ ì¤‘ 0ì¥ì—ë§Œ íƒ€ì´í‹€ ì¡´ì¬ (0%)
êµ¬í˜„ ìš”êµ¬ì‚¬í•­
Step 1: ë ˆì´ì•„ì›ƒ ì„ íƒ ë©”ì„œë“œ ì¶”ê°€
pythondef add_slide(self, layout_type: str = "title_and_content"):
    """
    ë ˆì´ì•„ì›ƒ íƒ€ì…ë³„ ìŠ¬ë¼ì´ë“œ ì¶”ê°€
    
    Args:
        layout_type: "title" | "title_and_content" | "section_header" | "blank"
    
    Returns:
        Slide ê°ì²´
    """
    layout_map = {
        "title": 0,              # ì²« ìŠ¬ë¼ì´ë“œìš©
        "title_and_content": 1,  # ì¼ë°˜ ìŠ¬ë¼ì´ë“œìš© (ê¸°ë³¸ê°’)
        "section_header": 2,     # ì„¹ì…˜ êµ¬ë¶„ìš©
        "blank": 6               # íŠ¹ìˆ˜ ë ˆì´ì•„ì›ƒìš©
    }
    
    layout_idx = layout_map.get(layout_type, 1)
    layout = self.prs.slide_layouts[layout_idx]
    return self.prs.slides.add_slide(layout)
Step 2: íƒ€ì´í‹€ ì¶”ê°€ ë©”ì„œë“œ ê°•í™”
pythondef add_title_to_slide(self, slide, title_text: str):
    """
    ìŠ¬ë¼ì´ë“œì— íƒ€ì´í‹€ ì¶”ê°€ (3ë‹¨ê³„ í´ë°± ì‹œìŠ¤í…œ)
    
    Priority:
    1. Title placeholder ì‚¬ìš©
    2. ê¸°ì¡´ textbox ì¬í™œìš©
    3. ìƒˆ textbox ìƒì„±
    """
    
    # 1ë‹¨ê³„: Title placeholder ì°¾ê¸°
    for shape in slide.shapes:
        if shape.is_placeholder:
            phf = shape.placeholder_format
            if phf.type == 1:  # PP_PLACEHOLDER.TITLE
                shape.text = title_text
                self._apply_title_style(shape)
                return True
    
    # 2ë‹¨ê³„: ê¸°ì¡´ textbox ì¬í™œìš©
    for shape in slide.shapes:
        if shape.has_text_frame and shape.top < Inches(1.0):
            shape.text = title_text
            self._apply_title_style(shape)
            return True
    
    # 3ë‹¨ê³„: ìƒˆ textbox ìƒì„±
    left = Inches(0.5)
    top = Inches(0.3)
    width = Inches(9.0)
    height = Inches(0.7)
    
    txBox = slide.shapes.add_textbox(left, top, width, height)
    tf = txBox.text_frame
    tf.text = title_text
    self._apply_title_style(txBox)
    
    return True

def _apply_title_style(self, shape):
    """McKinsey íƒ€ì´í‹€ ìŠ¤íƒ€ì¼ ì ìš©"""
    if not shape.has_text_frame:
        return
    
    text_frame = shape.text_frame
    for paragraph in text_frame.paragraphs:
        paragraph.alignment = PP_ALIGN.LEFT
        
        for run in paragraph.runs:
            run.font.name = 'Arial'
            run.font.size = Pt(24)
            run.font.bold = True
            run.font.color.rgb = RGBColor(0, 118, 168)  # McKinsey Blue
Step 3: ê¸°ì¡´ generate_presentation() ë©”ì„œë“œ ìˆ˜ì •
pythondef generate_presentation(self, slides_data: List[Dict]) -> str:
    """
    í”„ë ˆì  í…Œì´ì…˜ ìƒì„± (íƒ€ì´í‹€ ì ìš© ê°•í™”)
    """
    for i, slide_data in enumerate(slides_data):
        # ë ˆì´ì•„ì›ƒ ê²°ì •
        if i == 0:
            layout_type = "title"
        elif slide_data.get('type') == 'section':
            layout_type = "section_header"
        else:
            layout_type = "title_and_content"
        
        # ìŠ¬ë¼ì´ë“œ ì¶”ê°€
        slide = self.add_slide(layout_type)
        
        # íƒ€ì´í‹€ ì¶”ê°€ (í•„ìˆ˜!)
        title = slide_data.get('title') or slide_data.get('headline') or f"Slide {i+1}"
        self.add_title_to_slide(slide, title)
        
        # ì½˜í…ì¸  ì¶”ê°€
        content = slide_data.get('content', [])
        self._add_content_to_slide(slide, content)
    
    # ì €ì¥...
ê²€ì¦ ë°©ë²•
python# í…ŒìŠ¤íŠ¸ ì½”ë“œ
pptx = Presentation('output.pptx')
titles_found = 0

for slide in pptx.slides:
    for shape in slide.shapes:
        if shape.has_text_frame:
            text = shape.text.strip()
            if text and shape.top < Inches(1.0):
                titles_found += 1
                break

print(f"íƒ€ì´í‹€ ìˆëŠ” ìŠ¬ë¼ì´ë“œ: {titles_found}/{len(pptx.slides)}")
# ëª©í‘œ: 100% (11/11)

ğŸ”¥ Priority 2: ì°¨íŠ¸ ìƒì„± ë° ì‚½ì…
íŒŒì¼: app/services/chart_generator.py + workflow_orchestrator.py
í˜„ì¬ ë¬¸ì œ
python# ChartGeneratorê°€ í˜¸ì¶œë˜ì§€ ì•Šê±°ë‚˜
# ìƒì„±ëœ ì°¨íŠ¸ê°€ ìŠ¬ë¼ì´ë“œì— ì¶”ê°€ë˜ì§€ ì•ŠìŒ
# ê²°ê³¼: ì´ ì°¨íŠ¸ ìˆ˜ 0ê°œ
êµ¬í˜„ ìš”êµ¬ì‚¬í•­
Step 1: chart_generator.py ê°•í™”
pythonimport matplotlib.pyplot as plt
import matplotlib
matplotlib.use('Agg')  # GUI ì—†ëŠ” í™˜ê²½ìš©
from typing import Dict, List
import os

class ChartGenerator:
    """McKinsey ìŠ¤íƒ€ì¼ ì°¨íŠ¸ ìƒì„±"""
    
    def __init__(self):
        self.output_dir = "temp_charts"
        os.makedirs(self.output_dir, exist_ok=True)
        
        # McKinsey ìƒ‰ìƒ íŒ”ë ˆíŠ¸
        self.colors = {
            'primary': '#0076A8',
            'secondary': '#F47621',
            'positive': '#6BA644',
            'negative': '#E31B23',
            'neutral': '#53565A'
        }
    
    def generate_chart(self, chart_spec: Dict) -> str:
        """
        ì°¨íŠ¸ ìƒì„± ë° ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œ ë°˜í™˜
        
        Args:
            chart_spec: {
                'type': 'bar' | 'line' | 'pie' | 'waterfall',
                'data': {...},
                'title': str
            }
        
        Returns:
            ì´ë¯¸ì§€ íŒŒì¼ ì ˆëŒ€ ê²½ë¡œ
        """
        chart_type = chart_spec.get('type', 'bar')
        
        if chart_type == 'bar':
            return self._create_bar_chart(chart_spec)
        elif chart_type == 'line':
            return self._create_line_chart(chart_spec)
        elif chart_type == 'pie':
            return self._create_pie_chart(chart_spec)
        elif chart_type == 'waterfall':
            return self._create_waterfall_chart(chart_spec)
        else:
            return self._create_bar_chart(chart_spec)
    
    def _create_bar_chart(self, spec: Dict) -> str:
        """ë§‰ëŒ€ ì°¨íŠ¸ ìƒì„±"""
        fig, ax = plt.subplots(figsize=(8, 5))
        
        data = spec.get('data', {})
        categories = data.get('categories', ['A', 'B', 'C'])
        values = data.get('values', [10, 20, 30])
        
        # McKinsey ìŠ¤íƒ€ì¼ ì ìš©
        bars = ax.bar(categories, values, color=self.colors['primary'])
        
        # ê°’ ë ˆì´ë¸” ì¶”ê°€
        for bar in bars:
            height = bar.get_height()
            ax.text(bar.get_x() + bar.get_width()/2., height,
                   f'{height:.0f}',
                   ha='center', va='bottom', fontsize=10)
        
        # ìŠ¤íƒ€ì¼ ì„¤ì •
        ax.set_title(spec.get('title', ''), fontsize=14, fontweight='bold')
        ax.spines['top'].set_visible(False)
        ax.spines['right'].set_visible(False)
        ax.grid(axis='y', alpha=0.3)
        
        # ì €ì¥
        filepath = os.path.join(self.output_dir, f"chart_{spec.get('id', 'temp')}.png")
        plt.tight_layout()
        plt.savefig(filepath, dpi=150, bbox_inches='tight')
        plt.close()
        
        return os.path.abspath(filepath)
    
    def _create_line_chart(self, spec: Dict) -> str:
        """ì„  ì°¨íŠ¸ ìƒì„± (êµ¬í˜„ ìœ ì‚¬)"""
        # ... ë§‰ëŒ€ ì°¨íŠ¸ì™€ ìœ ì‚¬í•˜ê²Œ êµ¬í˜„
        pass
    
    def _create_waterfall_chart(self, spec: Dict) -> str:
        """ì›Œí„°í´ ì°¨íŠ¸ ìƒì„± (McKinsey í•„ìˆ˜)"""
        # ... êµ¬í˜„
        pass
Step 2: workflow_orchestrator.py ìˆ˜ì •
pythonasync def _execute_design_application(self, context: Dict) -> Dict:
    """
    ë””ìì¸ ì ìš© ë‹¨ê³„ - ì°¨íŠ¸ ìƒì„± ì¶”ê°€!
    """
    logger.info("=== Design Application Stage ===")
    
    # ê¸°ì¡´ ì½”ë“œ...
    design_result = await self.design_applicator.apply_design(...)
    
    # â˜…â˜…â˜… ì°¨íŠ¸ ìƒì„± ì¶”ê°€ â˜…â˜…â˜…
    chart_specs = context.get('data_analyst_result', {}).get('visualizations', [])
    
    if chart_specs:
        logger.info(f"ì°¨íŠ¸ ìƒì„± ì‹œì‘: {len(chart_specs)}ê°œ")
        chart_generator = ChartGenerator()
        
        chart_images = []
        for i, chart_spec in enumerate(chart_specs):
            try:
                chart_spec['id'] = f"chart_{i+1}"
                image_path = chart_generator.generate_chart(chart_spec)
                chart_images.append({
                    'path': image_path,
                    'slide_index': chart_spec.get('slide_index', i + 2),  # 2ë²ˆì§¸ ìŠ¬ë¼ì´ë“œë¶€í„°
                    'title': chart_spec.get('title', '')
                })
                logger.info(f"ì°¨íŠ¸ ìƒì„± ì„±ê³µ: {image_path}")
            except Exception as e:
                logger.error(f"ì°¨íŠ¸ ìƒì„± ì‹¤íŒ¨: {e}")
        
        design_result['chart_images'] = chart_images
    
    return design_result
Step 3: pptx_generator.pyì— ì°¨íŠ¸ ì‚½ì… ë©”ì„œë“œ ì¶”ê°€
pythondef add_chart_to_slide(self, slide, chart_image_path: str, position: str = "center"):
    """
    ìŠ¬ë¼ì´ë“œì— ì°¨íŠ¸ ì´ë¯¸ì§€ ì¶”ê°€
    
    Args:
        position: "center" | "right" | "left"
    """
    if not os.path.exists(chart_image_path):
        logger.error(f"ì°¨íŠ¸ ì´ë¯¸ì§€ ì—†ìŒ: {chart_image_path}")
        return False
    
    # ìœ„ì¹˜ ê³„ì‚°
    if position == "center":
        left = Inches(1.5)
        top = Inches(2.0)
        width = Inches(7.0)
        height = Inches(4.0)
    elif position == "right":
        left = Inches(5.5)
        top = Inches(1.5)
        width = Inches(4.0)
        height = Inches(4.5)
    else:  # left
        left = Inches(0.5)
        top = Inches(1.5)
        width = Inches(4.0)
        height = Inches(4.5)
    
    try:
        slide.shapes.add_picture(chart_image_path, left, top, width, height)
        return True
    except Exception as e:
        logger.error(f"ì°¨íŠ¸ ì¶”ê°€ ì‹¤íŒ¨: {e}")
        return False

def generate_presentation(self, slides_data: List[Dict], chart_images: List[Dict] = None):
    """
    í”„ë ˆì  í…Œì´ì…˜ ìƒì„± (ì°¨íŠ¸ í¬í•¨)
    """
    for i, slide_data in enumerate(slides_data):
        slide = self.add_slide(...)
        self.add_title_to_slide(slide, title)
        self._add_content_to_slide(slide, content)
        
        # â˜…â˜…â˜… ì°¨íŠ¸ ì¶”ê°€ â˜…â˜…â˜…
        if chart_images:
            for chart in chart_images:
                if chart.get('slide_index') == i:
                    self.add_chart_to_slide(slide, chart['path'], position="center")
ê²€ì¦ ë°©ë²•
python# ì°¨íŠ¸ ê°œìˆ˜ í™•ì¸
chart_count = 0
for slide in pptx.slides:
    for shape in slide.shapes:
        if shape.shape_type == 13:  # PICTURE
            chart_count += 1

print(f"ì´ ì°¨íŠ¸ ìˆ˜: {chart_count}ê°œ")
# ëª©í‘œ: ìµœì†Œ 3ê°œ ì´ìƒ

ğŸ”¥ Priority 3: McKinsey ìŠ¤íƒ€ì¼ ê°•ì œ ì ìš©
íŒŒì¼: app/agents/design_agent.py
êµ¬í˜„ ìš”êµ¬ì‚¬í•­
pythonclass DesignAgent(BaseAgent):
    
    async def process(self, input_data: Dict, context: Dict) -> Dict:
        """
        ë””ìì¸ ì²˜ë¦¬ - McKinsey ìŠ¤íƒ€ì¼ ê°•ì œ ì ìš©
        """
        result = await super().process(input_data, context)
        
        # â˜…â˜…â˜… ëª¨ë“  ìŠ¬ë¼ì´ë“œ ê°•ì œ ê²€ì¦ â˜…â˜…â˜…
        slides_data = result.get('enhanced_slides', [])
        
        for slide_data in slides_data:
            # 1. íƒ€ì´í‹€ í•„ìˆ˜ í™•ì¸
            if not slide_data.get('title') and not slide_data.get('headline'):
                slide_data['title'] = self._generate_default_title(slide_data)
            
            # 2. ì°¨íŠ¸ ì¶”ê°€ íŒë‹¨
            if self._should_add_chart(slide_data):
                chart_spec = self._create_chart_spec(slide_data)
                slide_data['chart'] = chart_spec
            
            # 3. McKinsey ìŠ¤íƒ€ì¼ ë©”íƒ€ë°ì´í„° ì¶”ê°€
            slide_data['style'] = {
                'font': 'Arial',
                'title_size': 24,
                'body_size': 14,
                'color': '#0076A8',
                'layout': slide_data.get('layout', 'title_and_content')
            }
        
        return result
    
    def _should_add_chart(self, slide_data: Dict) -> bool:
        """ì°¨íŠ¸ ì¶”ê°€ ì—¬ë¶€ íŒë‹¨"""
        content = slide_data.get('content', [])
        
        # ìˆ«ì ë°ì´í„°ê°€ 3ê°œ ì´ìƒ ìˆìœ¼ë©´ ì°¨íŠ¸ ì¶”ê°€
        numbers_count = sum(1 for item in content if self._contains_numbers(str(item)))
        
        return numbers_count >= 3
    
    def _create_chart_spec(self, slide_data: Dict) -> Dict:
        """ì°¨íŠ¸ ìŠ¤í™ ìƒì„±"""
        return {
            'type': 'bar',  # ê¸°ë³¸ê°’
            'data': self._extract_chart_data(slide_data),
            'title': slide_data.get('title', '')
        }
```

---

## âœ… ì „ì²´ ì‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ìˆ˜ì •í•  íŒŒì¼ (3ê°œ)
```
1. âœ… app/services/pptx_generator.py
   - add_slide() ë©”ì„œë“œ ì¶”ê°€
   - add_title_to_slide() ê°•í™”
   - _apply_title_style() ì¶”ê°€
   - add_chart_to_slide() ì¶”ê°€
   - generate_presentation() ìˆ˜ì •

2. âœ… app/services/chart_generator.py
   - ChartGenerator í´ë˜ìŠ¤ ê°•í™”
   - _create_bar_chart() êµ¬í˜„
   - _create_line_chart() êµ¬í˜„
   - _create_waterfall_chart() êµ¬í˜„

3. âœ… app/services/workflow_orchestrator.py
   - _execute_design_application() ìˆ˜ì •
   - ì°¨íŠ¸ ìƒì„± íŒŒì´í”„ë¼ì¸ ì¶”ê°€

4. âœ… app/agents/design_agent.py
   - process() ë©”ì„œë“œ ê°•í™”
   - _should_add_chart() ì¶”ê°€
   - _create_chart_spec() ì¶”ê°€
í…ŒìŠ¤íŠ¸ ë‹¨ê³„
bash# 1. Docker ì¬ë¹Œë“œ
docker-compose down
docker-compose up --build -d

# 2. E2E í…ŒìŠ¤íŠ¸
python examples/test_e2e_simple.py

# 3. ê²°ê³¼ í™•ì¸
# - íƒ€ì´í‹€: 11/11ì¥ (100%)
# - ì°¨íŠ¸: 3ê°œ ì´ìƒ
# - í’ˆì§ˆ ì ìˆ˜: 0.85 ì´ìƒ
```

---

## ğŸ“Š ì˜ˆìƒ ê°œì„  ê²°ê³¼
```
í˜„ì¬: 0.503
ëª©í‘œ: 0.850

ìˆ˜ì • í›„ ì˜ˆìƒ:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. Clarity:        0.40 â†’ 0.90 (+0.50) âœ…
2. Visual:         0.30 â†’ 0.85 (+0.55) âœ…
3. Structure:      0.70 (ìœ ì§€)         âœ…
4. Insight:        0.60 â†’ 0.75 (+0.15) âœ…
5. Actionability:  0.80 (ìœ ì§€)         âœ…
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ìµœì¢… ì˜ˆìƒ: 0.84 âœ… (ëª©í‘œ ë‹¬ì„±!)

ì´ ì‘ì—…ì§€ì‹œì„œë¥¼ Claude Codeì—ê²Œ ì œê³µí•˜ë©´, ë‹¨ê³„ë³„ë¡œ ëª…í™•í•œ ê°€ì´ë“œë¥¼ ë”°ë¼ ì½”ë“œë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ğŸš€ì¬ì‹œë„ClaudeëŠ” ì‹¤ìˆ˜ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‘ë‹µì„ ë°˜ë“œì‹œ ë‹¤ì‹œ í™•ì¸í•´ ì£¼ì„¸ìš”.PPT_ìƒì„±ì—”ì§„ êµ¬ì¶• í”„ë¡œì íŠ¸ Sonnet 4.5